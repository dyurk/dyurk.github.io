
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Get Email Notifications When Excel Workbook Has Been Amended. - DYURK | David Yurkiewicz</title>
  <meta name="author" content="David Yurkiewicz">

  
  <meta name="description" content="Recently I ran across a situation where i had an Excel workbook that was on a shared drive, this file would get updated by different employees on any &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dyurk.github.io/blog/2011/05/25/get-email-notifications-when-excel-workbook-has-been-amended">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="DYURK | David Yurkiewicz" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">DYURK | David Yurkiewicz</a></h1>
  
    <h2>A blog about WebOps, Sysadmin and Technology.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dyurk.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about_me">About Me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Get Email Notifications When Excel Workbook Has Been Amended.</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-25T14:23:02-04:00" pubdate data-updated="true">May 25<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Recently I ran across a situation where i had an Excel workbook that was on a shared drive, this file would get updated by different employees on any given time of the day. I need it a way to alert someone in management every time this file was amended. This was my solution:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Workbook_BeforeSave</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">SaveAsUI</span> <span class="ow">As</span> <span class="kt">Boolean</span><span class="p">,</span> <span class="n">Cancel</span> <span class="ow">As</span> <span class="kt">Boolean</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">OutApp</span> <span class="ow">As</span> <span class="kt">Object</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">OutMail</span> <span class="ow">As</span> <span class="kt">Object</span>
</span><span class='line'>    <span class="k">Const</span> <span class="n">SendTo</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;&lt;span style=&quot;c</span><span class="n">olor</span><span class="p">:</span> <span class="p">#</span><span class="mi">3366f</span><span class="n">f</span><span class="err">;</span><span class="s">&quot;&gt;davidy@Initech.com&lt;/span&gt;&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Set</span> <span class="n">OutApp</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Outlook.Application&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">OutApp</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">Logon</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">OutMail</span> <span class="o">=</span> <span class="n">OutApp</span><span class="p">.</span><span class="n">CreateItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">With</span> <span class="n">OutMail</span>
</span><span class='line'>        <span class="p">.</span><span class="n">To</span> <span class="o">=</span> <span class="n">SendTo</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Subject</span> <span class="o">=</span> <span class="n">ThisWorkbook</span><span class="p">.</span><span class="n">Name</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="s">&quot; has been amended&quot;</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Body</span> <span class="o">=</span> <span class="s">&quot; &lt;span style=&quot;c</span><span class="n">olor</span><span class="p">:</span> <span class="p">#</span><span class="mi">3366f</span><span class="n">f</span><span class="err">;</span><span class="s">&quot;&gt;The Workbook has been updated&lt;/span&gt;!&quot;</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Send</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Set</span> <span class="n">OutMail</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">OutApp</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure>


<p>This Visual basic code sends an email via Outlook every time the workbook has been updated. For this code to fully work you will need to edit your macro settings in Excel.</p>

<h2>Edit Macro Security Settings:</h2>


<p><strong>Office 2003</strong> &ndash; Tools &gt; Macro &gt; Security.
<strong>Office 2007</strong> &ndash; Click the Microsoft Office Button , and then click Excel Options. In the Trust Center category, click Trust Center Settings, and then click the Macro Settings category.</p>

<p><a href="http://d87studios.com/blog/wp-content/uploads/2011/05/macro_security.png"><img class="size-medium wp-image-155" title="macro_security_2003" src="http://d87studios.com/blog/wp-content/uploads/2011/05/macro_security-300x292.png" alt="Macro Security in Excel 2003" width="300" height="292" /></a></p>

<p>To make this VB code work correctly, you will need to set your Macro Security level to Medium or lower.</p>

<h2>Inserting the Code:</h2>


<p>Simply right click on the worksheet tab and click View Code. This will open the Microsoft Visual Basic screen.</p>

<p><a href="http://d87studios.com/blog/wp-content/uploads/2011/05/excel_viewcode.png"><img class="size-medium wp-image-157" title="excel_viewcode_2003" src="http://d87studios.com/blog/wp-content/uploads/2011/05/excel_viewcode-300x231.png" alt="Click View Code to open the Microsoft Visual Basic screen" width="300" height="231" /></a></p>

<p>Once you have the Microsoft VB screen open you can paste the code and begin editing it.</p>

<p style="text-align: center;">&nbsp;</p>


<p><a href="http://d87studios.com/blog/wp-content/uploads/2011/05/workbook_code.png"><img class="size-large wp-image-159" title="workbook_code" src="http://d87studios.com/blog/wp-content/uploads/2011/05/workbook_code-1024x571.png" alt="A view of the Microsoft Visual Basic screen" width="620" height="345" /></a></p>

<p style="text-align: left;">&nbsp;</p>


<p style="text-align: left;">Don&#8217;t forget to add your email address and if you would like to, you can customized the message that would be display on the body of the email. Just look at the highlighted parts on the picture above.</p>


<p style="text-align: center;">&nbsp;</p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">David Yurkiewicz</span></span>

      








  


<time datetime="2011-05-25T14:23:02-04:00" pubdate data-updated="true">May 25<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/editors-picks/'>Editors' Picks</a>, <a class='category' href='/blog/categories/technology/'>Technology</a>, <a class='category' href='/blog/categories/windows/'>Windows</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://dyurk.github.io/blog/2011/05/25/get-email-notifications-when-excel-workbook-has-been-amended/" data-via="d87tech" data-counturl="http://dyurk.github.io/blog/2011/05/25/get-email-notifications-when-excel-workbook-has-been-amended/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/05/18/batch-file-output-log-file/" title="Previous Post: Batch file output to Log file">&laquo; Batch file output to Log file</a>
      
      
        <a class="basic-alignment right" href="/blog/2011/06/02/joomla-upgrade-jupgrade-stuck/" title="Next Post: Joomla Upgrade. jUpgrade Stuck">Joomla Upgrade. jUpgrade Stuck &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/03/26/confluence-xml-import-issues/">Confluence XML Import Issues</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/12/apache-proxy-example/">Apache Proxy Example</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/06/cisco-catalyst-2960-notes/">Cisco Catalyst 2960 - Notes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/20/error-2006-hy000-mysql-server-has-gone-away/">ERROR 2006 (HY000) MySQL Server Has Gone Away</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/20/temporarily-disable-puppet/">Temporarily Disable Puppet</a>
      </li>
    
  </ul>
</section>
<section>
	<a class="twitter-timeline" href="https://twitter.com/d87tech" data-widget-id="414557421197983744">Tweets by @d87tech</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/dyurk">@dyurk</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dyurk',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - David Yurkiewicz -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'd87tech';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
